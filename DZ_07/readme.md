## I. –ó–∞–¥–∞–Ω–∏–µ.

–ù–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –∞—Ä—Ö–∏–≤–∞. 
–î–ª—è –∑–∞–ø—É—Å–∫–∞ valgrind —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ —Å —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–º –∞—Ä—Ö–∏–≤–æ–º:

```
cd test/package
make valgrind
```

### –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è
–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≤—ã–∫ –ø–æ–∏—Å–∫–∞ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏ —Å –ø–æ–º–æ—â—å—é valgrind

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞
1. –ù–∞–π–¥–µ–Ω–∞ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–Ω–∞ —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏, —Å–æ–∑–¥–∞–Ω patch, –∏—Å–ø—Ä–∞–≤–ª—è—é—â–∏–π —É—Ç–µ—á–∫—É.
2. –ë–æ–Ω—É—Å–Ω—ã–µ –±–∞–ª–ª—ã –∑–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É—Ç–µ—á–∫–∏.
3. –î–∞–ª–µ–µ —É—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–µ–≤—å—é –∫–æ–¥–∞.

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
> * –°–æ–∑–¥–∞–Ω–æ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª.
> * –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É.
> * –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç –Ω–∞ —ç–∫—Ä–∞–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ —Ñ–∞–π–ª–µ
–≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –µ—Å—Ç—å –≤ —Ñ–∞–π–ª–µ.
> * –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π —Å –∫–ª—é—á–∞–º–∏ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ -Wall -Wextra -Wpedantic -std=c11.

<p> &nbsp; </p> 


## II. –ö–∞–∫ –¥–µ–ª–∞–ª—Å—è –ø–æ–∏—Å–∫ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏.

> * –ó–∞–ø—É—Å—Ç–∏–ª valgrind. Rjvfylf **"cd /obmen/_git_OTUS_2023-C01/OTUS_2023_C07_HW/DZ_07/clib/test/package/"** –∏ **"make valgrind"**. 
> * –†–µ–∑—É–ª—å–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Ñ–∞–π–ª. –ü–æ–ª—É—á–∏–ª–æ—Å—å —á—É—Ç—å –±–æ–ª–µ–µ 1500 —Å—Ç—Ä–æ–∫ –∑–∞–ø–∏—Å–µ–π.
> * –í –ø–∞–ø–∫–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º –∑–∞–ø—É—Å—Ç–∏–ª –ø–æ–∏—Å–∫ —Å–ª–æ–≤–∞ "malloc". –ü–æ–ª—É—á–∏–ª 35 —Ñ–∞–π–ª–æ–≤ —Å —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π.
> * –í –ø–∞–ø–∫–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º –∑–∞–ø—É—Å—Ç–∏–ª –ø–æ–∏—Å–∫ —Å–ª–æ–≤–∞ "calloc". –ü–æ–ª—É—á–∏–ª 0 —Ñ–∞–π–ª–æ–≤.
> * –ò—Å–∫–∞–ª —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã valgrind —Å –æ—à–∏–±–∫–æ–π "definitely" –∏ —Å–ø–∏—Å–∫–æ–º —Ñ–∞–π–ª–æ–≤, –∏–º–µ—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏—é "mallcoc". –ü–æ–ª—É—á–∏–ª –≤—Å–µ–≥–æ 3 —Ñ–∞–π–ª–∞: "/src/common/clib-package.c", "/deps/strdup/strdup.c", "/deps/http-get/http-get.c".
> * –ò—Å–∫–∞–ª –≤–æ–∑–≤—Ä–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ malloc –∏ –≤ –∫–æ–Ω–µ—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (–∫—É–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏–ª –æ—Ç–≤–µ—Ç) –∏—Å–∫–∞–ª —Ñ—É–Ω–∫—Ü–∏—é free(...) –ø–æ –¥–∞–Ω–Ω–æ–º—É –∑–∞–ø—Ä–æ—Å—É.
> * –ß–∞—â–µ –≤—Å–µ–≥–æ –≤ –∫–æ–¥–µ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º —Ñ—É–Ω–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â—É—é mallco —Å—Ç–æ—è–ª–∞ –æ—á–∏—Å—Ç–∫–∞ —É–∫–∞–∑–∞—Ç–µ–ª—è "free((char*) –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)". –¢–∞–º –≥–¥–µ –Ω–µ –±—ã–ª–æ –æ—á–∏—Å—Ç–∫–∏ –Ω–∏ –¥–æ –Ω–∏ –ø–æ—Å–ª–µ, –¥–µ–ª–∞–ª –æ—á–∏—Å—Ç–∫—É –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏ –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é.
> * –†–∏—Å–∫–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ, —Ç.–∫ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–∑—ã–≤–∞–ª–∞—Å—å —Å—Ä–∞–∑—É –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ –≤—ã–¥–µ–ª–µ–Ω–∏—é –ø–∞–º—è—Ç–∏ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é –≤ –Ω–µ—ë —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞–±–æ—Ç—ã.
> * –í –∫–æ–¥–µ –Ω–∏–∂–µ - –µ—Å—Ç—å –ø–æ–º–µ—Ç–∫–∏ "???". –≠—Ç–∏ –±–ª–æ–∫–∏ –∫–æ–¥–∞ –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–∞ –ø–æ—Ç–æ–º, –µ—Å–ª–∏ —Å –ø–µ—Ä–≤–æ–π –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –±—ã–ª–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞.


```
—Ñ–∞–π–ª:strdup.c  		—Å—Ç—Ä 17:    char *buf = malloc(len);
—Ñ–∞–π–ª:http-get.c  	—Å—Ç—Ä 22:    res->data = malloc(realsize + 1);
—Ñ–∞–π–ª:http-get.c  	—Å—Ç—Ä 46:    http_get_response_t *res = malloc(sizeof(http_get_response_t));
.
—Ñ–∞–π–ª: clib-package.c   –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–π:
 –Ω–µ—Ç malloc -> nstall_packages (clib-package.c:370)		 = clib_package_new_from_slug(slug, verbose);
 –Ω–µ—Ç malloc -> install_packages (clib-package.c:374)		 = clib_package_install(pkg, dir, verbose);
 ......
 –ï–°–¢–¨ malloc (http-get.c   —Å—Ç—Ä 46)	clib_package_new_from_slug_with_package_name (clib-package.c:660) 
 					= http_get_shared(json_url, clib_package_curl_share);
 ......
 –Ω–µ—Ç malloc -> clib_package_new_from_slug (clib-package.c:796)	 = clib_package_new_from_slug_with_package_name(slug, verbose, name);
 ??? fetch_package_file_thread (clib-package.c:999)		 = int *status = malloc(sizeof(int));
 –Ω–µ—Ç malloc -> clib_package_install (clib-package.c:1383)	 = hash_set(visited_packages, strdup(pkg->name), "t");
 –Ω–µ—Ç malloc -> clib_package_install (clib-package.c:1579)	 = clib_package_install_dependencies(pkg, dir, verbose); 
 ??? clib_package_install_dependencies (clib-package.c:1615)     = install_packages(pkg->dependencies, dir, verbose);
```

<p> &nbsp; </p> 


## III. –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É.

–ï—Å–ª–∏ —É–∂–µ –±—ã–ª –∑–∞–ø—É—â–µ–Ω —Å–∫—Ä–∏–ø—Ç –ø–æ —Å–±–æ—Ä–∫–µ, —Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–π—Ç–∏ –≤ –ø–∞–ø–∫—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —á–µ—Ä–µ–∑ cd ... –∏ –∑–∞–Ω–æ–≤–æ –≤–≤–µ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—É, –∏–Ω–∞—á–µ —Å–¥–µ–ª–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è.

–°–∞–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ø–∞—Ç—á) —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ –ø–∞–ø–∫–µ "img".

<p> &nbsp; </p> 


## IV. –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã:

–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏, –≤—ã–¥–∞–Ω–Ω—ã–µ valgrind:
![–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏, –≤—ã–¥–∞–Ω–Ω—ã–µ valgrind](https://github.com/Sartakov-Aleksey/OTUS_2023_C07_HW/blob/main/DZ_07/img/all_error.png)

<p> &nbsp; </p> 

–û—à–∏–±–∫–∏, –≤—ã–¥–∞–Ω–Ω—ã–µ valgrind –ø–æ—Å–ª–µ –ø—Ä–∞–≤–∫–∏ –∫–æ–¥–∞ (—á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–¥–æ—á—ë—Ç–æ–≤):
![–ü–æ—Å–ª–µ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ–¥–æ—á—ë—Ç–æ–≤](https://github.com/Sartakov-Aleksey/OTUS_2023_C07_HW/blob/main/DZ_07/img/delete_error.png)

<p> &nbsp; </p> 

üòÇ –î–∞—Ç–∞ 26 —è–Ω–≤–∞—Ä—è 2024 –≥.

<p> &nbsp; </p> 
